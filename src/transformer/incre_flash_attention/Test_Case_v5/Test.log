[TEST] 🚀 开始 IncreFlashAttentionV5 完整测试套件
[TEST] ================================================
=== 测试日志输出 ===
[DEBUG][TestOp] This is a test debug message
[DEBUG][TestOp] Testing with parameters: 42, hello
[DEBUG][TestOp] Testing sInnerSize_=0, seqSize_=0
=== 日志测试完成 ===

[TEST] ✅ ACL环境初始化成功

[TEST] 开始执行测试用例...
[TEST] === 开始测试: IVF Sparse Mode ===
[TEST]   创建张量形状...
[TEST] 张量形状信息:
[TEST]   Query Shape: [1, 32, 1, 128]
[TEST]   Key Shape: [1, 32, 4096, 128]
[TEST]   Value Shape: [1, 32, 4096, 128]
[TEST]   Select Nprobe Shape: [1, 32, 64]
[TEST]   IVF Start Shape: [1, 32, 64]
[TEST]   IVF Length Shape: [1, 32, 64]
[TEST]   Attention Mask Shape: [1, 1, 1, 4096]
[TEST]   Output Shape: [1, 32, 1, 128]
[TEST]   测试参数: batchSize=1, numHeads=32, headDims=128, keyNumHeads=32, seqLenKV=4096
[TEST]   生成测试数据...
[TEST]     生成Query数据（小数值，避免Softmax溢出）...
[TEST]     生成Key数据（小数值，保持数值稳定）...
[TEST]     生成Value数据（小数值随机数）...
[TEST]     初始化输出张量为零...
[TEST]     数据质量检查:
[TEST]       Query - 均值: 0.010000, 范围: [0.010000, 0.010000]
[TEST]       Key - 均值: 0.009905, 范围: [0.010000, 0.010000]
[TEST]       Value - 均值: 0.009905, 范围: [0.010000, 0.010000]
[TEST]   生成稀疏数据...
[TEST]     聚类分布参数: 基础大小=64, 余数=0
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=0)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=1)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=2)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=3)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=4)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=5)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=6)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=7)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=8)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=9)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=10)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=11)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=12)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=13)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=14)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=15)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=16)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=17)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=18)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=19)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=20)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=21)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=22)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=23)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=24)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=25)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=26)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=27)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=28)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=29)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=30)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=31)
[TEST]   稀疏数据生成完成: 平均聚类大小=64，随机化分布
[TEST]   稀疏参数示例:
[TEST]     selectNprobe前5个值: [TEST] 0 [TEST] 1 [TEST] 2 [TEST] 3 [TEST] 4 [TEST] 
[TEST]     前5个聚类信息:
[TEST]       聚类[0]: 起始位置=0, 长度=64
[TEST]       聚类[1]: 起始位置=64, 长度=64
[TEST]       聚类[2]: 起始位置=128, 长度=64
[TEST]       聚类[3]: 起始位置=192, 长度=64
[TEST]       聚类[4]: 起始位置=256, 长度=64
[TEST]     聚类大小统计: 最小=64, 最大=64, 平均=64.00
[TEST]   开始全面验证聚类访问地址合法性...
[TEST]     ✅ 所有聚类访问地址验证通过！
[TEST]   验证selectNprobe与ivf数据的一致性...
[TEST]   前10个选中聚类的详细访问信息:
[TEST]     选择[0]: 聚类=0 -> 范围[0, 64), 长度=64
[TEST]     选择[1]: 聚类=1 -> 范围[64, 128), 长度=64
[TEST]     选择[2]: 聚类=2 -> 范围[128, 192), 长度=64
[TEST]     选择[3]: 聚类=3 -> 范围[192, 256), 长度=64
[TEST]     选择[4]: 聚类=4 -> 范围[256, 320), 长度=64
[TEST]     选择[5]: 聚类=5 -> 范围[320, 384), 长度=64
[TEST]     选择[6]: 聚类=6 -> 范围[384, 448), 长度=64
[TEST]     选择[7]: 聚类=7 -> 范围[448, 512), 长度=64
[TEST]     选择[8]: 聚类=8 -> 范围[512, 576), 长度=64
[TEST]     选择[9]: 聚类=9 -> 范围[576, 640), 长度=64
[TEST]   创建设备张量...
[TEST]   创建 query tensor...
[TEST]       数据转换: float32->float16，前5个值: [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 
[TEST]   创建 key tensor...
[TEST]       数据转换: float32->float16，前5个值: [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 
[TEST]   创建 value tensor...
[TEST]       数据转换: float32->float16，前5个值: [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 
[TEST]   创建 atten tensor...
[TEST]       INT8数据，前5个值: [TEST] 0 [TEST] 0 [TEST] 0 [TEST] 0 [TEST] 0 [TEST] 
[TEST]   创建 output tensor...
[TEST]       数据转换: float32->float16，前5个值: [TEST] 0.000000->0x0000 [TEST] 0.000000->0x0000 [TEST] 0.000000->0x0000 [TEST] 0.000000->0x0000 [TEST] 0.000000->0x0000 [TEST] 
[TEST]   创建稀疏参数 tensors...
[TEST]   创建张量列表...
[TEST]   创建序列长度数组...
[TEST]   设置算子参数...
[TEST]   算子参数: numHeads=32, scaleValue=0.088388, sparseMode=1, nprobe=64, clusterNum=64
[TEST]   调用 GetWorkspaceSize...
[DEBUG][IncreFlashAttention] Split: sparseMode_=1, IsFlashDecode()=0, seqSize_=4096
[DEBUG][IncreFlashAttention] CalcInnerSize: input seqSize=4096, antiQuantFlag_=0, nNumOfQInOneGroup_=1
[DEBUG][IncreFlashAttention] CalcInnerSize final result: sInnerSize_=4096, sInnerSizeAlign_=4096, sInnerLoopTimes_=1, sInnerSizeTail_=4096
[DEBUG][IncreFlashAttention] SplitSparse: following standard BN2 split logic
[DEBUG][IncreFlashAttention] BN2 params: bn=32, usedCoreNum=32, blockSplitBn2Range=1, tailSplitedBatchRange=0, formerCoreNum=32
[DEBUG][IncreFlashAttention] Sparse info: totalClusters=2048, clustersPerCore=64, nprobe=64, clusterNum=64
[DEBUG][IncreFlashAttention] GetBmm1Tiling input params: M=1, sInnerSize_=4096, headDim_=128, seqSize_=4096
[DEBUG][IncreFlashAttention] Initial bmm1BaseN calculation: Align(sInnerSize_=4096, 16U)=4096, baseN=256, result=256
[TEST]   GetWorkspaceSize 返回: 0, error: (null)
[TEST]   工作空间大小: 96616704 bytes
[TEST]   工作空间分配成功: 96616704 bytes
[TEST]   开始执行算子计算...
[TEST]  aclnnIncreFlashAttentionV5 执行前Log: (null)
opType=IncreFlashAttention, DumpHead: AIV-0, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 0,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=0, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=0)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=0 -> mappedKVHeadIdx=0
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=0
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079078
[DEBUG_BMM2] bmm2ResUb[1] = 1.098330
[DEBUG_BMM2] bmm2ResUb[2] = 1.117582
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009588
[DEBUG_CAST] bmm2ResUb[1] = 0.009759
[DEBUG_CAST] bmm2ResUb[2] = 0.009930
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-1, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 1,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=1, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=1)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=1 -> mappedKVHeadIdx=1
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=1
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078717
[DEBUG_BMM2] bmm2ResUb[1] = 1.097969
[DEBUG_BMM2] bmm2ResUb[2] = 1.117341
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009584
[DEBUG_CAST] bmm2ResUb[1] = 0.009755
[DEBUG_CAST] bmm2ResUb[2] = 0.009927
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-2, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 2,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=2, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=2)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=2 -> mappedKVHeadIdx=2
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=2
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079198
[DEBUG_BMM2] bmm2ResUb[1] = 1.098330
[DEBUG_BMM2] bmm2ResUb[2] = 1.117582
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009589
[DEBUG_CAST] bmm2ResUb[1] = 0.009759
[DEBUG_CAST] bmm2ResUb[2] = 0.009930
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-3, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 3,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=3, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=3)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=3 -> mappedKVHeadIdx=3
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=3
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078717
[DEBUG_BMM2] bmm2ResUb[1] = 1.097969
[DEBUG_BMM2] bmm2ResUb[2] = 1.117341
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009584
[DEBUG_CAST] bmm2ResUb[1] = 0.009755
[DEBUG_CAST] bmm2ResUb[2] = 0.009927
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-4, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 4,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=4, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=4)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=4 -> mappedKVHeadIdx=4
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=4
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079559
[DEBUG_BMM2] bmm2ResUb[1] = 1.098691
[DEBUG_BMM2] bmm2ResUb[2] = 1.117823
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009592
[DEBUG_CAST] bmm2ResUb[1] = 0.009762
[DEBUG_CAST] bmm2ResUb[2] = 0.009932
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-5, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 5,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=5, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=5)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=5 -> mappedKVHeadIdx=5
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=5
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079198
[DEBUG_BMM2] bmm2ResUb[1] = 1.098330
[DEBUG_BMM2] bmm2ResUb[2] = 1.117582
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009589
[DEBUG_CAST] bmm2ResUb[1] = 0.009759
[DEBUG_CAST] bmm2ResUb[2] = 0.009930
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-6, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 6,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=6, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=6)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=6 -> mappedKVHeadIdx=6
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=6
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.081003
[DEBUG_BMM2] bmm2ResUb[1] = 1.100135
[DEBUG_BMM2] bmm2ResUb[2] = 1.119267
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009605
[DEBUG_CAST] bmm2ResUb[1] = 0.009775
[DEBUG_CAST] bmm2ResUb[2] = 0.009945
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-7, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 7,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=7, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=7)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=7 -> mappedKVHeadIdx=7
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=7
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079078
[DEBUG_BMM2] bmm2ResUb[1] = 1.098330
[DEBUG_BMM2] bmm2ResUb[2] = 1.117582
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009588
[DEBUG_CAST] bmm2ResUb[1] = 0.009759
[DEBUG_CAST] bmm2ResUb[2] = 0.009930
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-8, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 8,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=8, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=8)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=8 -> mappedKVHeadIdx=8
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=8
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079800
[DEBUG_BMM2] bmm2ResUb[1] = 1.098932
[DEBUG_BMM2] bmm2ResUb[2] = 1.118184
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009594
[DEBUG_CAST] bmm2ResUb[1] = 0.009764
[DEBUG_CAST] bmm2ResUb[2] = 0.009935
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-9, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 9,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=9, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=9)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=9 -> mappedKVHeadIdx=9
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=9
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079198
[DEBUG_BMM2] bmm2ResUb[1] = 1.098330
[DEBUG_BMM2] bmm2ResUb[2] = 1.117582
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009589
[DEBUG_CAST] bmm2ResUb[1] = 0.009759
[DEBUG_CAST] bmm2ResUb[2] = 0.009930
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-10, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 10,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=10, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=10)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=10 -> mappedKVHeadIdx=10
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=10
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078717
[DEBUG_BMM2] bmm2ResUb[1] = 1.097849
[DEBUG_BMM2] bmm2ResUb[2] = 1.117101
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009584
[DEBUG_CAST] bmm2ResUb[1] = 0.009754
[DEBUG_CAST] bmm2ResUb[2] = 0.009925
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-11, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 11,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=11, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=11)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=11 -> mappedKVHeadIdx=11
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=11
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078476
[DEBUG_BMM2] bmm2ResUb[1] = 1.097608
[DEBUG_BMM2] bmm2ResUb[2] = 1.116980
[DEBUG_BMM2] bmm2ResUb[3] = 1.124681
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009582
[DEBUG_CAST] bmm2ResUb[1] = 0.009752
[DEBUG_CAST] bmm2ResUb[2] = 0.009924
[DEBUG_CAST] bmm2ResUb[3] = 0.009993
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-12, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 12,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=12, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=12)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=12 -> mappedKVHeadIdx=12
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=12
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078717
[DEBUG_BMM2] bmm2ResUb[1] = 1.097969
[DEBUG_BMM2] bmm2ResUb[2] = 1.117341
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009584
[DEBUG_CAST] bmm2ResUb[1] = 0.009755
[DEBUG_CAST] bmm2ResUb[2] = 0.009927
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-13, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 13,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=13, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=13)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=13 -> mappedKVHeadIdx=13
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=13
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078837
[DEBUG_BMM2] bmm2ResUb[1] = 1.097969
[DEBUG_BMM2] bmm2ResUb[2] = 1.117341
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009585
[DEBUG_CAST] bmm2ResUb[1] = 0.009755
[DEBUG_CAST] bmm2ResUb[2] = 0.009927
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-14, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 14,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=14, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=14)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=14 -> mappedKVHeadIdx=14
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=14
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079559
[DEBUG_BMM2] bmm2ResUb[1] = 1.098691
[DEBUG_BMM2] bmm2ResUb[2] = 1.117823
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009592
[DEBUG_CAST] bmm2ResUb[1] = 0.009762
[DEBUG_CAST] bmm2ResUb[2] = 0.009932
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-15, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 15,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=15, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=15)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=15 -> mappedKVHeadIdx=15
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=15
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.080040
[DEBUG_BMM2] bmm2ResUb[1] = 1.099293
[DEBUG_BMM2] bmm2ResUb[2] = 1.118424
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009596
[DEBUG_CAST] bmm2ResUb[1] = 0.009767
[DEBUG_CAST] bmm2ResUb[2] = 0.009937
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-16, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 16,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=16, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=16)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=16 -> mappedKVHeadIdx=16
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=16
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079078
[DEBUG_BMM2] bmm2ResUb[1] = 1.098330
[DEBUG_BMM2] bmm2ResUb[2] = 1.117582
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009588
[DEBUG_CAST] bmm2ResUb[1] = 0.009759
[DEBUG_CAST] bmm2ResUb[2] = 0.009930
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-17, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 17,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=17, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=17)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=17 -> mappedKVHeadIdx=17
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=17
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078717
[DEBUG_BMM2] bmm2ResUb[1] = 1.097969
[DEBUG_BMM2] bmm2ResUb[2] = 1.117341
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009584
[DEBUG_CAST] bmm2ResUb[1] = 0.009755
[DEBUG_CAST] bmm2ResUb[2] = 0.009927
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-18, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 18,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=18, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=18)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=18 -> mappedKVHeadIdx=18
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=18
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079559
[DEBUG_BMM2] bmm2ResUb[1] = 1.098691
[DEBUG_BMM2] bmm2ResUb[2] = 1.117823
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009592
[DEBUG_CAST] bmm2ResUb[1] = 0.009762
[DEBUG_CAST] bmm2ResUb[2] = 0.009932
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-19, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 19,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=19, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=19)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=19 -> mappedKVHeadIdx=19
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=19
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079559
[DEBUG_BMM2] bmm2ResUb[1] = 1.098691
[DEBUG_BMM2] bmm2ResUb[2] = 1.117823
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009592
[DEBUG_CAST] bmm2ResUb[1] = 0.009762
[DEBUG_CAST] bmm2ResUb[2] = 0.009932
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-20, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 20,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=20, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=20)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=20 -> mappedKVHeadIdx=20
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=20
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078476
[DEBUG_BMM2] bmm2ResUb[1] = 1.097608
[DEBUG_BMM2] bmm2ResUb[2] = 1.116980
[DEBUG_BMM2] bmm2ResUb[3] = 1.124681
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009582
[DEBUG_CAST] bmm2ResUb[1] = 0.009752
[DEBUG_CAST] bmm2ResUb[2] = 0.009924
[DEBUG_CAST] bmm2ResUb[3] = 0.009993
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-21, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 21,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=21, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=21)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=21 -> mappedKVHeadIdx=21
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=21
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078717
[DEBUG_BMM2] bmm2ResUb[1] = 1.097969
[DEBUG_BMM2] bmm2ResUb[2] = 1.117341
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009584
[DEBUG_CAST] bmm2ResUb[1] = 0.009755
[DEBUG_CAST] bmm2ResUb[2] = 0.009927
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-22, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 22,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=22, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=22)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=22 -> mappedKVHeadIdx=22
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=22
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078958
[DEBUG_BMM2] bmm2ResUb[1] = 1.098210
[DEBUG_BMM2] bmm2ResUb[2] = 1.117341
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009586
[DEBUG_CAST] bmm2ResUb[1] = 0.009758
[DEBUG_CAST] bmm2ResUb[2] = 0.009927
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-23, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 23,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=23, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=23)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=23 -> mappedKVHeadIdx=23
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=23
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078717
[DEBUG_BMM2] bmm2ResUb[1] = 1.097969
[DEBUG_BMM2] bmm2ResUb[2] = 1.117341
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009584
[DEBUG_CAST] bmm2ResUb[1] = 0.009755
[DEBUG_CAST] bmm2ResUb[2] = 0.009927
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-24, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 24,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=24, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=24)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=24 -> mappedKVHeadIdx=24
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=24
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078476
[DEBUG_BMM2] bmm2ResUb[1] = 1.097608
[DEBUG_BMM2] bmm2ResUb[2] = 1.116980
[DEBUG_BMM2] bmm2ResUb[3] = 1.124681
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009582
[DEBUG_CAST] bmm2ResUb[1] = 0.009752
[DEBUG_CAST] bmm2ResUb[2] = 0.009924
[DEBUG_CAST] bmm2ResUb[3] = 0.009993
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-25, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 25,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=25, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=25)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=25 -> mappedKVHeadIdx=25
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=25
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078717
[DEBUG_BMM2] bmm2ResUb[1] = 1.097969
[DEBUG_BMM2] bmm2ResUb[2] = 1.117341
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009584
[DEBUG_CAST] bmm2ResUb[1] = 0.009755
[DEBUG_CAST] bmm2ResUb[2] = 0.009927
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-26, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 26,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=26, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=26)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=26 -> mappedKVHeadIdx=26
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=26
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.078958
[DEBUG_BMM2] bmm2ResUb[1] = 1.098210
[DEBUG_BMM2] bmm2ResUb[2] = 1.117341
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009586
[DEBUG_CAST] bmm2ResUb[1] = 0.009758
[DEBUG_CAST] bmm2ResUb[2] = 0.009927
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-27, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 27,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=27, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=27)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=27 -> mappedKVHeadIdx=27
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=27
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079559
[DEBUG_BMM2] bmm2ResUb[1] = 1.098691
[DEBUG_BMM2] bmm2ResUb[2] = 1.117823
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009592
[DEBUG_CAST] bmm2ResUb[1] = 0.009762
[DEBUG_CAST] bmm2ResUb[2] = 0.009932
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-28, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 28,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=28, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=28)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=28 -> mappedKVHeadIdx=28
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=28
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079078
[DEBUG_BMM2] bmm2ResUb[1] = 1.098330
[DEBUG_BMM2] bmm2ResUb[2] = 1.117582
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009588
[DEBUG_CAST] bmm2ResUb[1] = 0.009759
[DEBUG_CAST] bmm2ResUb[2] = 0.009930
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-29, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 29,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=29, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=29)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=29 -> mappedKVHeadIdx=29
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=29
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079559
[DEBUG_BMM2] bmm2ResUb[1] = 1.098691
[DEBUG_BMM2] bmm2ResUb[2] = 1.117823
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009592
[DEBUG_CAST] bmm2ResUb[1] = 0.009762
[DEBUG_CAST] bmm2ResUb[2] = 0.009932
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-30, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 30,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=30, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=30)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=30 -> mappedKVHeadIdx=30
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=30
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079559
[DEBUG_BMM2] bmm2ResUb[1] = 1.098691
[DEBUG_BMM2] bmm2ResUb[2] = 1.117823
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009592
[DEBUG_CAST] bmm2ResUb[1] = 0.009762
[DEBUG_CAST] bmm2ResUb[2] = 0.009932
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIV-31, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=969032, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 31,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] FP16模式：bmm1ResUb初始化为%.6f，避免数值问题
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=-50.000000, [1]=-50.000000, [2]=-50.000000, [3]=-50.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=31, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=31)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=31 -> mappedKVHeadIdx=31
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=31
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=128, ANTIQUANT=0
[FP16_SPARSE] FP16模式检测，使用安全的初始化值
[FP16_SPARSE] bmm1ResUb初始化完成，使用值: %.6f
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 首次写入位置[0:64]
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[64:128]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[128:192]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[192:256]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[256:320]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[320:384]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[384:448]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[448:512]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[512:576]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[576:640]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[640:704]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[704:768]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[768:832]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[832:896]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[896:960]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[960:1024]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1024:1088]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1088:1152]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1152:1216]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1216:1280]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1280:1344]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1344:1408]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1408:1472]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1472:1536]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1536:1600]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1600:1664]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1664:1728]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1728:1792]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1792:1856]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1856:1920]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1920:1984]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[1984:2048]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2048:2112]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2112:2176]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2176:2240]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2240:2304]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2304:2368]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2368:2432]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2432:2496]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2496:2560]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2560:2624]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2624:2688]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2688:2752]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2752:2816]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2816:2880]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2880:2944]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[2944:3008]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3008:3072]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3072:3136]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3136:3200]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3200:3264]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3264:3328]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3328:3392]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3392:3456]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3456:3520]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3520:3584]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3584:3648]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3648:3712]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3712:3776]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3776:3840]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3840:3904]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3904:3968]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[3968:4032]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[FP16_SPARSE] FP16模式稀疏计算，computeRows=64, headDimAlign=128, headDim=128
[FP16_SPARSE] qk[0] = %.6f
[FP16_SPARSE] qk[1] = %.6f
[FP16_SPARSE] qk[2] = %.6f
[FP16_SPARSE] qk[3] = %.6f
[FP16_SPARSE] 累积写入位置[4032:4096]
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.012786
[DEBUG_QK] bmm1ResUb[1] = 0.012786
[DEBUG_QK] bmm1ResUb[2] = 0.012786
[DEBUG_QK] bmm1ResUb[3] = 0.012786
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.012786 bmm1[1]=0.012786 bmm1[2]=0.012786 bmm1[3]=0.012786 bmm1[4]=0.012786 bmm1[5]=0.012786 bmm1[6]=0.012786 bmm1[7]=0.012786 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.001130 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=112.550255, max=0.001130
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.001130, softmaxSumUb[0]=112.550255
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1.079559
[DEBUG_BMM2] bmm2ResUb[1] = 1.098691
[DEBUG_BMM2] bmm2ResUb[2] = 1.117823
[DEBUG_BMM2] bmm2ResUb[3] = 1.124802
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009592
[DEBUG_CAST] bmm2ResUb[1] = 0.009762
[DEBUG_CAST] bmm2ResUb[2] = 0.009932
[DEBUG_CAST] bmm2ResUb[3] = 0.009994
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
opType=IncreFlashAttention, DumpHead: AIC-0, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-1, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-2, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-3, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-4, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-5, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-6, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-7, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-8, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-9, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-10, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-11, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-12, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-13, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-14, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-15, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INVOKE_IFA_SPARSE_ALL_VEC_OP_IMPL
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[TEST]  aclnnIncreFlashAttentionV5 执行后Log: (null)
[TEST]   ✅ 算子执行成功
[TEST]   等待计算完成...
[TEST]   aclrtSynchronizeStream 执行Log: (null)
[TEST]   ✅ 计算完成，流同步成功
[TEST]   开始读取计算结果...
[TEST]   ✅ 结果拷贝成功
[TEST] 
=== 计算结果分析 ===
[TEST] 输出张量形状: [1, 32, 1, 128]
[TEST] 输出张量总元素数: 4096
[TEST] 统计信息:
[TEST]   均值 (Mean): 0.009912
[TEST]   标准差 (Std): 0.000867
[TEST]   最小值 (Min): 0.000156
[TEST]   最大值 (Max): 0.009995
[TEST]   求和 (Sum): 40.600006
[TEST] 
前16个输出元素(排除column-0):
[TEST]   [TEST] 0.009590 [TEST] 0.009758 [TEST] 0.009926 [TEST] 0.009995 [TEST] 
[TEST]   [TEST] 0.009995 [TEST] 0.009995 [TEST] 0.009995 [TEST] 0.009995 [TEST] 
[TEST]   [TEST] 0.009995 [TEST] 0.009995 [TEST] 0.009995 [TEST] 0.009995 [TEST] 
[TEST]   [TEST] 0.009995 [TEST] 0.009995 [TEST] 0.009995 [TEST] 0.009995 [TEST] 
[TEST]   ... (仅显示前16个有效元素)
[TEST] 
结果合理性检查:
[TEST]   包含NaN: 否
[TEST]   包含Inf: 否
[TEST]   零值元素数: 0
[TEST]   非零元素数: 4096
[TEST]   数值范围: [0.000156, 0.009995]
[TEST]   ✅ 结果数值范围合理
[TEST] === 结果分析完成 ===

[TEST] ✅ Sparse Mode: PASS
[TEST] === 开始测试: INT8 KV Input Mode with IVF Sparse ===
[TEST]   创建张量形状...
[TEST] 张量形状信息:
[TEST]   Query Shape: [1, 32, 1, 128]
[TEST]   Key Shape (INT8): [1, 32, 4096, 128]
[TEST]   Value Shape (INT8): [1, 32, 4096, 128]
[TEST]   AntiQuantScale Shape: [2, 32, 1, 128]
[TEST]   AntiQuantOffset Shape: [2, 32, 1, 128]
[TEST]   Select Nprobe Shape: [1, 32, 64]
[TEST]   IVF Start Shape: [1, 32, 64]
[TEST]   IVF Length Shape: [1, 32, 64]
[TEST]   Output Shape: [1, 32, 1, 128]
[TEST]   测试参数: batchSize=1, numHeads=32, headDims=128, keyNumHeads=32, seqLenKV=4096
[TEST]   稀疏参数: nprobe=64, clusterNum=64
[TEST]   生成测试数据...
[TEST]   生成稀疏数据...
[TEST]     聚类分布参数: 基础大小=64, 余数=0
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=0)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=1)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=2)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=3)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=4)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=5)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=6)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=7)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=8)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=9)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=10)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=11)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=12)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=13)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=14)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=15)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=16)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=17)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=18)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=19)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=20)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=21)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=22)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=23)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=24)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=25)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=26)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=27)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=28)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=29)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=30)
[TEST]     ✅ 聚类分布正确: 总长度=4096 (batch=0, head=31)
[TEST]   数据统计:
[TEST]     Query: 均值=0.010000, 范围=[0.010000, 0.010000] (常数值)
[TEST]     Key (INT8): 范围=[-32, 32] (缩小范围)
[TEST]     Value (INT8): 范围=[-32, 32] (缩小范围)
[TEST]     AntiQuantScale: 均值=0.100000 (增大缩放因子)
[TEST]     AntiQuantOffset: 均值=0.000000
[TEST]     稀疏参数: nprobe=64, clusterNum=64, baseClusterSize=64
[TEST]     预期反量化后Key/Value范围: [-3.2, 3.2] (INT8 * scale)
[TEST]   创建设备张量...
[TEST]       数据转换: float32->float16，前5个值: [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 
[TEST]       INT8数据，前5个值: [TEST] -32 [TEST] 76 [TEST] 116 [TEST] -81 [TEST] 60 [TEST] 
[TEST]       INT8数据，前5个值: [TEST] -53 [TEST] 82 [TEST] -126 [TEST] 57 [TEST] 74 [TEST] 
[TEST]       数据转换: float32->float16，前5个值: [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 0.010000->0x211E [TEST] 
[TEST]       数据转换: float32->float16，前5个值: [TEST] 0.000000->0x0000 [TEST] 0.000000->0x0000 [TEST] 0.000000->0x0000 [TEST] 0.000000->0x0000 [TEST] 0.000000->0x0000 [TEST] 
[TEST]       INT8数据，前5个值: [TEST] 0 [TEST] 0 [TEST] 0 [TEST] 0 [TEST] 0 [TEST] 
[TEST]       数据转换: float32->float16，前5个值: [TEST] 0.000000->0x0000 [TEST] 0.000000->0x0000 [TEST] 0.000000->0x0000 [TEST] 0.000000->0x0000 [TEST] 0.000000->0x0000 [TEST] 
[TEST]   创建稀疏参数 tensors...
[TEST]   设置算子参数...
[TEST]   算子参数: numHeads=32, scaleValue=0.088388, sparseMode=1, nprobe=64, clusterNum=64
[TEST]   调用 GetWorkspaceSize...
[DEBUG][IncreFlashAttention] Split: sparseMode_=1, IsFlashDecode()=0, seqSize_=4096
[DEBUG][IncreFlashAttention] CalcInnerSize: input seqSize=4096, antiQuantFlag_=1, nNumOfQInOneGroup_=1
[DEBUG][IncreFlashAttention] CalcInnerSize final result: sInnerSize_=4096, sInnerSizeAlign_=4096, sInnerLoopTimes_=1, sInnerSizeTail_=4096
[DEBUG][IncreFlashAttention] SplitSparse: following standard BN2 split logic
[DEBUG][IncreFlashAttention] BN2 params: bn=32, usedCoreNum=32, blockSplitBn2Range=1, tailSplitedBatchRange=0, formerCoreNum=32
[DEBUG][IncreFlashAttention] Sparse info: totalClusters=2048, clustersPerCore=64, nprobe=64, clusterNum=64
[DEBUG][IncreFlashAttention] GetBmm1Tiling input params: M=2, sInnerSize_=4096, headDim_=128, seqSize_=4096
[DEBUG][IncreFlashAttention] Initial bmm1BaseN calculation: Align(sInnerSize_=4096, 16U)=4096, baseN=512, result=512
[TEST]   GetWorkspaceSize 成功, 工作空间大小: 98693376 bytes
[TEST]   工作空间分配成功: 98693376 bytes
[TEST]   开始执行算子计算...
[TEST]  aclnnIncreFlashAttentionV5 执行前Log: (null)
opType=IncreFlashAttention, DumpHead: AIV-0, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 0,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=0, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=0)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=0 -> mappedKVHeadIdx=0
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=0
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 659.000000
[DEBUG_BMM2] bmm2ResUb[1] = -1809.000000
[DEBUG_BMM2] bmm2ResUb[2] = -6664.000000
[DEBUG_BMM2] bmm2ResUb[3] = -1223.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.001608
[DEBUG_CAST] bmm2ResUb[1] = -0.004414
[DEBUG_CAST] bmm2ResUb[2] = -0.016261
[DEBUG_CAST] bmm2ResUb[3] = -0.002984
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-1, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 1,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=1, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=1)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=1 -> mappedKVHeadIdx=1
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=1
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -3029.000000
[DEBUG_BMM2] bmm2ResUb[1] = -4731.000000
[DEBUG_BMM2] bmm2ResUb[2] = -9964.000000
[DEBUG_BMM2] bmm2ResUb[3] = -6859.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.007391
[DEBUG_CAST] bmm2ResUb[1] = -0.011544
[DEBUG_CAST] bmm2ResUb[2] = -0.024313
[DEBUG_CAST] bmm2ResUb[3] = -0.016736
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-2, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 2,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=2, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=2)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=2 -> mappedKVHeadIdx=2
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=2
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -1664.000000
[DEBUG_BMM2] bmm2ResUb[1] = -1407.000000
[DEBUG_BMM2] bmm2ResUb[2] = 2467.000000
[DEBUG_BMM2] bmm2ResUb[3] = -1213.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.004060
[DEBUG_CAST] bmm2ResUb[1] = -0.003433
[DEBUG_CAST] bmm2ResUb[2] = 0.006020
[DEBUG_CAST] bmm2ResUb[3] = -0.002960
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-3, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 3,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=3, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=3)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=3 -> mappedKVHeadIdx=3
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=3
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 1964.000000
[DEBUG_BMM2] bmm2ResUb[1] = -4010.000000
[DEBUG_BMM2] bmm2ResUb[2] = -6789.000000
[DEBUG_BMM2] bmm2ResUb[3] = 1788.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.004792
[DEBUG_CAST] bmm2ResUb[1] = -0.009785
[DEBUG_CAST] bmm2ResUb[2] = -0.016566
[DEBUG_CAST] bmm2ResUb[3] = 0.004363
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-4, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 4,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=4, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=4)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=4 -> mappedKVHeadIdx=4
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=4
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -414.000000
[DEBUG_BMM2] bmm2ResUb[1] = 146.000000
[DEBUG_BMM2] bmm2ResUb[2] = 992.000000
[DEBUG_BMM2] bmm2ResUb[3] = 2748.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.001010
[DEBUG_CAST] bmm2ResUb[1] = 0.000356
[DEBUG_CAST] bmm2ResUb[2] = 0.002421
[DEBUG_CAST] bmm2ResUb[3] = 0.006705
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-5, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 5,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=5, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=5)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=5 -> mappedKVHeadIdx=5
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=5
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -7921.000000
[DEBUG_BMM2] bmm2ResUb[1] = -7837.000000
[DEBUG_BMM2] bmm2ResUb[2] = 3430.000000
[DEBUG_BMM2] bmm2ResUb[3] = 7912.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.019328
[DEBUG_CAST] bmm2ResUb[1] = -0.019123
[DEBUG_CAST] bmm2ResUb[2] = 0.008369
[DEBUG_CAST] bmm2ResUb[3] = 0.019306
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-6, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 6,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=6, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=6)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=6 -> mappedKVHeadIdx=6
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=6
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -9095.000000
[DEBUG_BMM2] bmm2ResUb[1] = -331.000000
[DEBUG_BMM2] bmm2ResUb[2] = 1265.000000
[DEBUG_BMM2] bmm2ResUb[3] = 5643.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.022192
[DEBUG_CAST] bmm2ResUb[1] = -0.000808
[DEBUG_CAST] bmm2ResUb[2] = 0.003087
[DEBUG_CAST] bmm2ResUb[3] = 0.013769
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-7, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 7,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=7, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=7)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=7 -> mappedKVHeadIdx=7
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=7
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -6593.000000
[DEBUG_BMM2] bmm2ResUb[1] = -12848.000000
[DEBUG_BMM2] bmm2ResUb[2] = -9163.000000
[DEBUG_BMM2] bmm2ResUb[3] = -9907.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.016087
[DEBUG_CAST] bmm2ResUb[1] = -0.031350
[DEBUG_CAST] bmm2ResUb[2] = -0.022358
[DEBUG_CAST] bmm2ResUb[3] = -0.024174
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-8, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 8,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=8, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=8)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=8 -> mappedKVHeadIdx=8
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=8
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -1423.000000
[DEBUG_BMM2] bmm2ResUb[1] = -3999.000000
[DEBUG_BMM2] bmm2ResUb[2] = 549.000000
[DEBUG_BMM2] bmm2ResUb[3] = 4563.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.003472
[DEBUG_CAST] bmm2ResUb[1] = -0.009758
[DEBUG_CAST] bmm2ResUb[2] = 0.001340
[DEBUG_CAST] bmm2ResUb[3] = 0.011134
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-9, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 9,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=9, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=9)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=9 -> mappedKVHeadIdx=9
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=9
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -9748.000000
[DEBUG_BMM2] bmm2ResUb[1] = -3233.000000
[DEBUG_BMM2] bmm2ResUb[2] = 1317.000000
[DEBUG_BMM2] bmm2ResUb[3] = -2919.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.023786
[DEBUG_CAST] bmm2ResUb[1] = -0.007889
[DEBUG_CAST] bmm2ResUb[2] = 0.003214
[DEBUG_CAST] bmm2ResUb[3] = -0.007123
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-10, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 10,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=10, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=10)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=10 -> mappedKVHeadIdx=10
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=10
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -6947.000000
[DEBUG_BMM2] bmm2ResUb[1] = 2496.000000
[DEBUG_BMM2] bmm2ResUb[2] = -5132.000000
[DEBUG_BMM2] bmm2ResUb[3] = 3803.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.016951
[DEBUG_CAST] bmm2ResUb[1] = 0.006090
[DEBUG_CAST] bmm2ResUb[2] = -0.012522
[DEBUG_CAST] bmm2ResUb[3] = 0.009280
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-11, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 11,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=11, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=11)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=11 -> mappedKVHeadIdx=11
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=11
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -3450.000000
[DEBUG_BMM2] bmm2ResUb[1] = -3911.000000
[DEBUG_BMM2] bmm2ResUb[2] = -1774.000000
[DEBUG_BMM2] bmm2ResUb[3] = -9507.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.008418
[DEBUG_CAST] bmm2ResUb[1] = -0.009543
[DEBUG_CAST] bmm2ResUb[2] = -0.004329
[DEBUG_CAST] bmm2ResUb[3] = -0.023198
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-12, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 12,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=12, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=12)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=12 -> mappedKVHeadIdx=12
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=12
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 6828.000000
[DEBUG_BMM2] bmm2ResUb[1] = 5866.000000
[DEBUG_BMM2] bmm2ResUb[2] = 2274.000000
[DEBUG_BMM2] bmm2ResUb[3] = -1263.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.016661
[DEBUG_CAST] bmm2ResUb[1] = 0.014313
[DEBUG_CAST] bmm2ResUb[2] = 0.005549
[DEBUG_CAST] bmm2ResUb[3] = -0.003082
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-13, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 13,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=13, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=13)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=13 -> mappedKVHeadIdx=13
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=13
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 2226.000000
[DEBUG_BMM2] bmm2ResUb[1] = -6558.000000
[DEBUG_BMM2] bmm2ResUb[2] = -8729.000000
[DEBUG_BMM2] bmm2ResUb[3] = -3224.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.005432
[DEBUG_CAST] bmm2ResUb[1] = -0.016002
[DEBUG_CAST] bmm2ResUb[2] = -0.021299
[DEBUG_CAST] bmm2ResUb[3] = -0.007867
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-14, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 14,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=14, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=14)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=14 -> mappedKVHeadIdx=14
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=14
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -4052.000000
[DEBUG_BMM2] bmm2ResUb[1] = 8632.000000
[DEBUG_BMM2] bmm2ResUb[2] = -4061.000000
[DEBUG_BMM2] bmm2ResUb[3] = -5247.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.009887
[DEBUG_CAST] bmm2ResUb[1] = 0.021063
[DEBUG_CAST] bmm2ResUb[2] = -0.009909
[DEBUG_CAST] bmm2ResUb[3] = -0.012803
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-15, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 15,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=15, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=15)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=15 -> mappedKVHeadIdx=15
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=15
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -3837.000000
[DEBUG_BMM2] bmm2ResUb[1] = -1475.000000
[DEBUG_BMM2] bmm2ResUb[2] = -2173.000000
[DEBUG_BMM2] bmm2ResUb[3] = -10541.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.009363
[DEBUG_CAST] bmm2ResUb[1] = -0.003599
[DEBUG_CAST] bmm2ResUb[2] = -0.005302
[DEBUG_CAST] bmm2ResUb[3] = -0.025721
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-16, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 16,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=16, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=16)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=16 -> mappedKVHeadIdx=16
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=16
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -2280.000000
[DEBUG_BMM2] bmm2ResUb[1] = 1058.000000
[DEBUG_BMM2] bmm2ResUb[2] = 2352.000000
[DEBUG_BMM2] bmm2ResUb[3] = -3851.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.005563
[DEBUG_CAST] bmm2ResUb[1] = 0.002582
[DEBUG_CAST] bmm2ResUb[2] = 0.005739
[DEBUG_CAST] bmm2ResUb[3] = -0.009397
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-17, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 17,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=17, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=17)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=17 -> mappedKVHeadIdx=17
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=17
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 136.000000
[DEBUG_BMM2] bmm2ResUb[1] = -1174.000000
[DEBUG_BMM2] bmm2ResUb[2] = -3082.000000
[DEBUG_BMM2] bmm2ResUb[3] = -567.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.000332
[DEBUG_CAST] bmm2ResUb[1] = -0.002865
[DEBUG_CAST] bmm2ResUb[2] = -0.007520
[DEBUG_CAST] bmm2ResUb[3] = -0.001384
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-18, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 18,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=18, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=18)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=18 -> mappedKVHeadIdx=18
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=18
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 5242.000000
[DEBUG_BMM2] bmm2ResUb[1] = 2103.000000
[DEBUG_BMM2] bmm2ResUb[2] = -1252.000000
[DEBUG_BMM2] bmm2ResUb[3] = -6639.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.012791
[DEBUG_CAST] bmm2ResUb[1] = 0.005131
[DEBUG_CAST] bmm2ResUb[2] = -0.003055
[DEBUG_CAST] bmm2ResUb[3] = -0.016200
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-19, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 19,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=19, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=19)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=19 -> mappedKVHeadIdx=19
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=19
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -4586.000000
[DEBUG_BMM2] bmm2ResUb[1] = -3361.000000
[DEBUG_BMM2] bmm2ResUb[2] = -12825.000000
[DEBUG_BMM2] bmm2ResUb[3] = -8984.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.011190
[DEBUG_CAST] bmm2ResUb[1] = -0.008201
[DEBUG_CAST] bmm2ResUb[2] = -0.031294
[DEBUG_CAST] bmm2ResUb[3] = -0.021922
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-20, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 20,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=20, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=20)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=20 -> mappedKVHeadIdx=20
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=20
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 825.000000
[DEBUG_BMM2] bmm2ResUb[1] = -6102.000000
[DEBUG_BMM2] bmm2ResUb[2] = -1110.000000
[DEBUG_BMM2] bmm2ResUb[3] = -5024.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.002013
[DEBUG_CAST] bmm2ResUb[1] = -0.014889
[DEBUG_CAST] bmm2ResUb[2] = -0.002708
[DEBUG_CAST] bmm2ResUb[3] = -0.012259
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-21, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 21,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=21, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=21)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=21 -> mappedKVHeadIdx=21
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=21
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 3869.000000
[DEBUG_BMM2] bmm2ResUb[1] = 2124.000000
[DEBUG_BMM2] bmm2ResUb[2] = -1603.000000
[DEBUG_BMM2] bmm2ResUb[3] = 5980.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.009441
[DEBUG_CAST] bmm2ResUb[1] = 0.005183
[DEBUG_CAST] bmm2ResUb[2] = -0.003911
[DEBUG_CAST] bmm2ResUb[3] = 0.014592
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-22, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 22,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=22, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=22)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=22 -> mappedKVHeadIdx=22
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=22
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 731.000000
[DEBUG_BMM2] bmm2ResUb[1] = -7747.000000
[DEBUG_BMM2] bmm2ResUb[2] = -3821.000000
[DEBUG_BMM2] bmm2ResUb[3] = -3978.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.001784
[DEBUG_CAST] bmm2ResUb[1] = -0.018903
[DEBUG_CAST] bmm2ResUb[2] = -0.009323
[DEBUG_CAST] bmm2ResUb[3] = -0.009707
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-23, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 23,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=23, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=23)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=23 -> mappedKVHeadIdx=23
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=23
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -5217.000000
[DEBUG_BMM2] bmm2ResUb[1] = -1191.000000
[DEBUG_BMM2] bmm2ResUb[2] = -2575.000000
[DEBUG_BMM2] bmm2ResUb[3] = -3380.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.012730
[DEBUG_CAST] bmm2ResUb[1] = -0.002906
[DEBUG_CAST] bmm2ResUb[2] = -0.006283
[DEBUG_CAST] bmm2ResUb[3] = -0.008247
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-24, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 24,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=24, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=24)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=24 -> mappedKVHeadIdx=24
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=24
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -6848.000000
[DEBUG_BMM2] bmm2ResUb[1] = -3487.000000
[DEBUG_BMM2] bmm2ResUb[2] = -5282.000000
[DEBUG_BMM2] bmm2ResUb[3] = -611.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.016710
[DEBUG_CAST] bmm2ResUb[1] = -0.008509
[DEBUG_CAST] bmm2ResUb[2] = -0.012888
[DEBUG_CAST] bmm2ResUb[3] = -0.001491
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-25, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 25,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=25, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=25)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=25 -> mappedKVHeadIdx=25
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=25
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -7514.000000
[DEBUG_BMM2] bmm2ResUb[1] = -10231.000000
[DEBUG_BMM2] bmm2ResUb[2] = -1064.000000
[DEBUG_BMM2] bmm2ResUb[3] = -4037.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.018335
[DEBUG_CAST] bmm2ResUb[1] = -0.024964
[DEBUG_CAST] bmm2ResUb[2] = -0.002596
[DEBUG_CAST] bmm2ResUb[3] = -0.009851
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-26, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 26,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=26, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=26)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=26 -> mappedKVHeadIdx=26
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=26
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -1418.000000
[DEBUG_BMM2] bmm2ResUb[1] = 1636.000000
[DEBUG_BMM2] bmm2ResUb[2] = -7535.000000
[DEBUG_BMM2] bmm2ResUb[3] = -2961.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.003460
[DEBUG_CAST] bmm2ResUb[1] = 0.003992
[DEBUG_CAST] bmm2ResUb[2] = -0.018386
[DEBUG_CAST] bmm2ResUb[3] = -0.007225
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-27, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 27,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=27, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=27)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=27 -> mappedKVHeadIdx=27
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=27
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 437.000000
[DEBUG_BMM2] bmm2ResUb[1] = -5960.000000
[DEBUG_BMM2] bmm2ResUb[2] = -1136.000000
[DEBUG_BMM2] bmm2ResUb[3] = -8259.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.001066
[DEBUG_CAST] bmm2ResUb[1] = -0.014543
[DEBUG_CAST] bmm2ResUb[2] = -0.002772
[DEBUG_CAST] bmm2ResUb[3] = -0.020152
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-28, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 28,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=28, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=28)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=28 -> mappedKVHeadIdx=28
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=28
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -694.000000
[DEBUG_BMM2] bmm2ResUb[1] = 846.000000
[DEBUG_BMM2] bmm2ResUb[2] = -190.000000
[DEBUG_BMM2] bmm2ResUb[3] = -10716.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.001693
[DEBUG_CAST] bmm2ResUb[1] = 0.002064
[DEBUG_CAST] bmm2ResUb[2] = -0.000464
[DEBUG_CAST] bmm2ResUb[3] = -0.026148
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-29, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 29,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=29, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=29)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=29 -> mappedKVHeadIdx=29
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=29
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 581.000000
[DEBUG_BMM2] bmm2ResUb[1] = -4868.000000
[DEBUG_BMM2] bmm2ResUb[2] = -5146.000000
[DEBUG_BMM2] bmm2ResUb[3] = -983.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.001418
[DEBUG_CAST] bmm2ResUb[1] = -0.011878
[DEBUG_CAST] bmm2ResUb[2] = -0.012557
[DEBUG_CAST] bmm2ResUb[3] = -0.002399
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-30, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 30,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=30, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=30)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=30 -> mappedKVHeadIdx=30
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=30
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = 8287.000000
[DEBUG_BMM2] bmm2ResUb[1] = -2694.000000
[DEBUG_BMM2] bmm2ResUb[2] = -4010.000000
[DEBUG_BMM2] bmm2ResUb[3] = -4284.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = 0.020221
[DEBUG_CAST] bmm2ResUb[1] = -0.006574
[DEBUG_CAST] bmm2ResUb[2] = -0.009785
[DEBUG_CAST] bmm2ResUb[3] = -0.010453
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIV-31, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=999952, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[IFA LOG] >>> Calling Init()\n[IFA LOG] >>> Calling InitQuant()\n[IFA LOG] >>> Calling InitSparse()\n[DEBUG_SPARSE] InitSparse: 稀疏参数初始化
[DEBUG_SPARSE] sparseMode=1, nprobe=64, clusterNum=64, maxClusterSize=128
[DEBUG_SPARSE] batchSize=1, qHeadNum=32, kvHeadNum=32, kvSeqSize=4096
[V5_SPARSE] InitSparse: 稀疏参数初始化成功，所有指针已对齐
[DEBUG_SPARSE] 开始安全检查稀疏参数内容
[DEBUG_SPARSE] GQA参数: qHeadNum=32, kvHeadNum=32, ratio=1
[DEBUG_SPARSE] 检查selectNprobe前4个值:
[DEBUG_SPARSE] selectNprobe[0][0][0] = 0
[DEBUG_SPARSE] selectNprobe[0][0][1] = 1
[DEBUG_SPARSE] selectNprobe[0][0][2] = 2
[DEBUG_SPARSE] selectNprobe[0][0][3] = 3
[DEBUG_SPARSE] 检查ivfStart/ivfLen前4个值:
[DEBUG_SPARSE] ivfStart[0][0][0] = 0, ivfLen[0][0][0] = 64
[DEBUG_SPARSE] ivfStart[0][0][1] = 64, ivfLen[0][0][1] = 64
[DEBUG_SPARSE] ivfStart[0][0][2] = 128, ivfLen[0][0][2] = 64
[DEBUG_SPARSE] ivfStart[0][0][3] = 192, ivfLen[0][0][3] = 64
[DEBUG_SPARSE] 稀疏参数内容检查完成
[SPARSE_FOCUS] 稀疏计算专用模式 - 强制修复而非回退
[SPARSE_FOCUS] 预期张量大小:
[SPARSE_FOCUS]   selectNprobe: 2048 元素 (bs=1 * qh=32 * nprobe=64)
[SPARSE_FOCUS]   ivfStart/Len: 2048 元素 (bs=1 * kvh=32 * cluster=64)
[SPARSE_STANDARD] 标准MHA场景，qHead==kvHead=32
[SPARSE_FOCUS] 稀疏模式已启用，将强制进行稀疏计算！
[SPARSE_FOCUS] 如有错误将直接暴露，便于精确定位和修复
[IFA LOG] >>> Calling Process()\nEntering Process
Entering InitCalcParams
Entering for loop
bn2LoopTimes: 1
Entering GetBN2id
Start_remainSinnerSize: 4096,  sInnerLoopTimes: 1, 
tmpBlockIdx: 31,  batchSize: 1,  kvHeadNum: 32,  splitKVNum: 1 
Mid_remainSinnerSize: 4096,  sInnerLoopTimes: 1
[V5_SPARSE_FLOW] Entering sparse one-shot execution path.
Entering SInnerLoopFunc
Entering SparseBmm1Compute
[SPARSE_BMM1] INT8模式：bmm1ResUb初始化为0
[DEBUG_QK] 初始化后bmm1ResUb前4个值: [0]=0.000000, [1]=0.000000, [2]=0.000000, [3]=0.000000
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算开始 ==========
[V5_SPARSE] SparseBmm1Compute: 参数检查 - sparseFlag=1, sparseMode=1
[V5_SPARSE] SparseBmm1Compute: 稀疏参数验证通过
[V5_SPARSE] SparseBmm1Compute: 当前处理 - bIdx=0, n2Idx=31, nprobe=64, clusterNum=64
[V5_SPARSE] SparseBmm1Compute: 序列参数 - kvSeqSize=4096, actualSingleProcessSInnerSize=4096, s2BatchOffset=0
[V5_SPARSE] SparseBmm1Compute: 开始分配稀疏索引张量，大小=64
[V5_SPARSE] SparseBmm1Compute: 加载聚类索引 - ComputeSparseKVAccess(bIdx=0, n2Idx=31)
[V5_SPARSE] SparseBmm1Compute: 开始聚类预处理和验证
[V5_SPARSE] ValidateClusterBounds: 聚类[0:64]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[64:128]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[128:192]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[192:256]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[256:320]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[320:384]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[384:448]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[448:512]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[512:576]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[576:640]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[640:704]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[704:768]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[768:832]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[832:896]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[896:960]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[960:1024]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1024:1088]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1088:1152]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1152:1216]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1216:1280]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1280:1344]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1344:1408]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1408:1472]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1472:1536]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1536:1600]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1600:1664]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1664:1728]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1728:1792]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1792:1856]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1856:1920]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1920:1984]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[1984:2048]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2048:2112]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2112:2176]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2176:2240]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2240:2304]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2304:2368]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2368:2432]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2432:2496]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2496:2560]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2560:2624]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2624:2688]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2688:2752]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2752:2816]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2816:2880]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2880:2944]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[2944:3008]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3008:3072]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3072:3136]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3136:3200]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3200:3264]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3264:3328]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3328:3392]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3392:3456]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3456:3520]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3520:3584]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3584:3648]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3648:3712]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3712:3776]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3776:3840]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3840:3904]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3904:3968]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[3968:4032]边界检查通过
[V5_SPARSE] ValidateClusterBounds: 聚类[4032:4096]边界检查通过
[V5_SPARSE] SparseBmm1Compute: 聚类预处理完成 - 有效聚类数=64/64
[V5_SPARSE] SparseBmm1Compute: Q头映射 - n2Idx=31 -> mappedKVHeadIdx=31
[V5_SPARSE] SparseBmm1Compute: 开始稀疏QK计算，处理64个有效聚类
[SPARSE_CORRECT] 🎯 开始正确的稀疏注意力计算
[SPARSE_CORRECT] 参数: validClusterNum=64, actualSingleProcessSInnerSize=4096, qHeadIdx=31
[SPARSE_CORRECT] INT8模式优化: MAX_K_COPY_ROWS=64, ANTIQUANT=1
[SPARSE_CORRECT] 处理聚类[0]: 全局位置[0:64], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 位置0已被聚类[0]覆盖
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[0]计算完成，写入位置[0:64]
[SPARSE_CORRECT] 处理聚类[1]: 全局位置[64:128], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[1]计算完成，写入位置[64:128]
[SPARSE_CORRECT] 处理聚类[2]: 全局位置[128:192], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[2]计算完成，写入位置[128:192]
[SPARSE_CORRECT] 处理聚类[3]: 全局位置[192:256], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[3]计算完成，写入位置[192:256]
[SPARSE_CORRECT] 处理聚类[4]: 全局位置[256:320], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[4]计算完成，写入位置[256:320]
[SPARSE_CORRECT] 处理聚类[5]: 全局位置[320:384], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[5]计算完成，写入位置[320:384]
[SPARSE_CORRECT] 处理聚类[6]: 全局位置[384:448], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[6]计算完成，写入位置[384:448]
[SPARSE_CORRECT] 处理聚类[7]: 全局位置[448:512], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[7]计算完成，写入位置[448:512]
[SPARSE_CORRECT] 处理聚类[8]: 全局位置[512:576], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[8]计算完成，写入位置[512:576]
[SPARSE_CORRECT] 处理聚类[9]: 全局位置[576:640], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[9]计算完成，写入位置[576:640]
[SPARSE_CORRECT] 处理聚类[10]: 全局位置[640:704], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[10]计算完成，写入位置[640:704]
[SPARSE_CORRECT] 处理聚类[11]: 全局位置[704:768], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[11]计算完成，写入位置[704:768]
[SPARSE_CORRECT] 处理聚类[12]: 全局位置[768:832], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[12]计算完成，写入位置[768:832]
[SPARSE_CORRECT] 处理聚类[13]: 全局位置[832:896], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[13]计算完成，写入位置[832:896]
[SPARSE_CORRECT] 处理聚类[14]: 全局位置[896:960], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[14]计算完成，写入位置[896:960]
[SPARSE_CORRECT] 处理聚类[15]: 全局位置[960:1024], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[15]计算完成，写入位置[960:1024]
[SPARSE_CORRECT] 处理聚类[16]: 全局位置[1024:1088], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[16]计算完成，写入位置[1024:1088]
[SPARSE_CORRECT] 处理聚类[17]: 全局位置[1088:1152], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[17]计算完成，写入位置[1088:1152]
[SPARSE_CORRECT] 处理聚类[18]: 全局位置[1152:1216], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[18]计算完成，写入位置[1152:1216]
[SPARSE_CORRECT] 处理聚类[19]: 全局位置[1216:1280], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[19]计算完成，写入位置[1216:1280]
[SPARSE_CORRECT] 处理聚类[20]: 全局位置[1280:1344], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[20]计算完成，写入位置[1280:1344]
[SPARSE_CORRECT] 处理聚类[21]: 全局位置[1344:1408], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[21]计算完成，写入位置[1344:1408]
[SPARSE_CORRECT] 处理聚类[22]: 全局位置[1408:1472], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[22]计算完成，写入位置[1408:1472]
[SPARSE_CORRECT] 处理聚类[23]: 全局位置[1472:1536], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[23]计算完成，写入位置[1472:1536]
[SPARSE_CORRECT] 处理聚类[24]: 全局位置[1536:1600], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[24]计算完成，写入位置[1536:1600]
[SPARSE_CORRECT] 处理聚类[25]: 全局位置[1600:1664], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[25]计算完成，写入位置[1600:1664]
[SPARSE_CORRECT] 处理聚类[26]: 全局位置[1664:1728], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[26]计算完成，写入位置[1664:1728]
[SPARSE_CORRECT] 处理聚类[27]: 全局位置[1728:1792], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[27]计算完成，写入位置[1728:1792]
[SPARSE_CORRECT] 处理聚类[28]: 全局位置[1792:1856], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[28]计算完成，写入位置[1792:1856]
[SPARSE_CORRECT] 处理聚类[29]: 全局位置[1856:1920], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[29]计算完成，写入位置[1856:1920]
[SPARSE_CORRECT] 处理聚类[30]: 全局位置[1920:1984], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[30]计算完成，写入位置[1920:1984]
[SPARSE_CORRECT] 处理聚类[31]: 全局位置[1984:2048], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[31]计算完成，写入位置[1984:2048]
[SPARSE_CORRECT] 处理聚类[32]: 全局位置[2048:2112], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[32]计算完成，写入位置[2048:2112]
[SPARSE_CORRECT] 处理聚类[33]: 全局位置[2112:2176], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[33]计算完成，写入位置[2112:2176]
[SPARSE_CORRECT] 处理聚类[34]: 全局位置[2176:2240], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[34]计算完成，写入位置[2176:2240]
[SPARSE_CORRECT] 处理聚类[35]: 全局位置[2240:2304], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[35]计算完成，写入位置[2240:2304]
[SPARSE_CORRECT] 处理聚类[36]: 全局位置[2304:2368], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[36]计算完成，写入位置[2304:2368]
[SPARSE_CORRECT] 处理聚类[37]: 全局位置[2368:2432], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[37]计算完成，写入位置[2368:2432]
[SPARSE_CORRECT] 处理聚类[38]: 全局位置[2432:2496], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[38]计算完成，写入位置[2432:2496]
[SPARSE_CORRECT] 处理聚类[39]: 全局位置[2496:2560], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[39]计算完成，写入位置[2496:2560]
[SPARSE_CORRECT] 处理聚类[40]: 全局位置[2560:2624], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[40]计算完成，写入位置[2560:2624]
[SPARSE_CORRECT] 处理聚类[41]: 全局位置[2624:2688], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[41]计算完成，写入位置[2624:2688]
[SPARSE_CORRECT] 处理聚类[42]: 全局位置[2688:2752], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[42]计算完成，写入位置[2688:2752]
[SPARSE_CORRECT] 处理聚类[43]: 全局位置[2752:2816], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[43]计算完成，写入位置[2752:2816]
[SPARSE_CORRECT] 处理聚类[44]: 全局位置[2816:2880], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[44]计算完成，写入位置[2816:2880]
[SPARSE_CORRECT] 处理聚类[45]: 全局位置[2880:2944], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[45]计算完成，写入位置[2880:2944]
[SPARSE_CORRECT] 处理聚类[46]: 全局位置[2944:3008], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[46]计算完成，写入位置[2944:3008]
[SPARSE_CORRECT] 处理聚类[47]: 全局位置[3008:3072], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[47]计算完成，写入位置[3008:3072]
[SPARSE_CORRECT] 处理聚类[48]: 全局位置[3072:3136], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[48]计算完成，写入位置[3072:3136]
[SPARSE_CORRECT] 处理聚类[49]: 全局位置[3136:3200], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[49]计算完成，写入位置[3136:3200]
[SPARSE_CORRECT] 处理聚类[50]: 全局位置[3200:3264], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[50]计算完成，写入位置[3200:3264]
[SPARSE_CORRECT] 处理聚类[51]: 全局位置[3264:3328], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[51]计算完成，写入位置[3264:3328]
[SPARSE_CORRECT] 处理聚类[52]: 全局位置[3328:3392], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[52]计算完成，写入位置[3328:3392]
[SPARSE_CORRECT] 处理聚类[53]: 全局位置[3392:3456], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[53]计算完成，写入位置[3392:3456]
[SPARSE_CORRECT] 处理聚类[54]: 全局位置[3456:3520], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[54]计算完成，写入位置[3456:3520]
[SPARSE_CORRECT] 处理聚类[55]: 全局位置[3520:3584], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[55]计算完成，写入位置[3520:3584]
[SPARSE_CORRECT] 处理聚类[56]: 全局位置[3584:3648], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[56]计算完成，写入位置[3584:3648]
[SPARSE_CORRECT] 处理聚类[57]: 全局位置[3648:3712], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[57]计算完成，写入位置[3648:3712]
[SPARSE_CORRECT] 处理聚类[58]: 全局位置[3712:3776], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[58]计算完成，写入位置[3712:3776]
[SPARSE_CORRECT] 处理聚类[59]: 全局位置[3776:3840], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[59]计算完成，写入位置[3776:3840]
[SPARSE_CORRECT] 处理聚类[60]: 全局位置[3840:3904], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[60]计算完成，写入位置[3840:3904]
[SPARSE_CORRECT] 处理聚类[61]: 全局位置[3904:3968], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[61]计算完成，写入位置[3904:3968]
[SPARSE_CORRECT] 处理聚类[62]: 全局位置[3968:4032], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[62]计算完成，写入位置[3968:4032]
[SPARSE_CORRECT] 处理聚类[63]: 全局位置[4032:4096], 长度=64
[SPARSE_CORRECT] 分块处理: rawRows=64 computeRows=64 padRows=0
[SPARSE_CORRECT] 警告：per-channel模式使用简化处理
[SPARSE_CORRECT] 分块完成: dealtRows=64 remainRows=0
[SPARSE_CORRECT] 聚类[63]计算完成，写入位置[4032:4096]
[SPARSE_CORRECT] ✅ 稀疏注意力计算完成，成功处理了64个聚类，位置0覆盖状态：已覆盖
[DEBUG_QK] 稀疏计算完成后bmm1ResUb前4个值:
[DEBUG_QK] bmm1ResUb[0] = 0.000000
[DEBUG_QK] bmm1ResUb[1] = 0.000000
[DEBUG_QK] bmm1ResUb[2] = 0.000000
[DEBUG_QK] bmm1ResUb[3] = 0.000000
[DEBUG_QK] 稀疏QK结果检查前16个元素: hasNaN=false
[V5_SPARSE] SparseBmm1Compute: ========== V5稀疏注意力计算完成 ==========
Exiting SparseBmm1Compute
Entering ProcessVec1(sInnerLoopIdx=0)
[DEBUG_VEC1_ENTRY] sInnerLoopIdx=0, actualSingleProcessSInnerSize=4096
[DEBUG_VEC1_IN] bmm1ResUb before ElewiseCompute:
bmm1[0]=0.000000 bmm1[1]=0.000000 bmm1[2]=0.000000 bmm1[3]=0.000000 bmm1[4]=0.000000 bmm1[5]=0.000000 bmm1[6]=0.000000 bmm1[7]=0.000000 
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 开始，检查输入数值范围
[DEBUG_SOFTMAX] 输入首个值: 0.000000 (安全阈值: 50.000000)
[DEBUG_SOFTMAX] SoftmaxFlashV2Compute 完成，验证输出
[DEBUG_SOFTMAX] Softmax结果: sum=4096.000000, max=0.000000
[DEBUG_VEC1_SOFTMAX] After SoftmaxFlashV2Compute:
softmaxMaxUb[0]=0.000000, softmaxSumUb[0]=4096.000000
[DEBUG_VEC1_OUT] bmm1ResUb (Attention Weights) after Softmax:
attn[0]=1.000000 attn[1]=1.000000 attn[2]=1.000000 attn[3]=1.000000 attn[4]=1.000000 attn[5]=1.000000 attn[6]=1.000000 attn[7]=1.000000 
Exiting ProcessVec1(sInnerLoopIdx=0)
Entering Bmm2Compute
Exiting Bmm2Compute
[DEBUG_BMM2] Bmm2Compute后bmm2ResUb前4个值:
[DEBUG_BMM2] bmm2ResUb[0] = -5183.000000
[DEBUG_BMM2] bmm2ResUb[1] = -6618.000000
[DEBUG_BMM2] bmm2ResUb[2] = -2387.000000
[DEBUG_BMM2] bmm2ResUb[3] = 1502.000000
Entering ProcessVec2(sInnerLoopIdx=0)
[DEBUG_CAST] Bmm2CastAndCopyOut开始 - FLASH_DECODE=1
[DEBUG_CAST] 参数: startRow=0, dealRowCount=1, columnCount=128, actualColumnCount=128
[DEBUG_CAST] 转换前bmm2ResUb前4个值:
[DEBUG_CAST] bmm2ResUb[0] = -0.012647
[DEBUG_CAST] bmm2ResUb[1] = -0.016148
[DEBUG_CAST] bmm2ResUb[2] = -0.005824
[DEBUG_CAST] bmm2ResUb[3] = 0.003665
Exiting ProcessVec2(sInnerLoopIdx=0)
SInnerLoopFunc completed for sInnerLoopIdx=0
Leaving for loop
[IFA LOG] <<< All operator functions done.\nLeaving INT8 KV Input Mode with BNSD layout
opType=IncreFlashAttention, DumpHead: AIC-0, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-1, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-2, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-3, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-4, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-5, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-6, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-7, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-8, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-9, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-10, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-11, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-12, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-13, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-14, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\nopType=IncreFlashAttention, DumpHead: AIC-15, CoreType=MIX, block dim=16, total_block_num=48, block_remain_len=1048304, block_initial_space=1048576, rsv=0, magic=5aa5bccd
CANN Version: 8.1.RC1.alpha002, TimeStamp: 20250409195004623
Entering INT8 KV Input Mode with BNSD layout
[IFA LOG] >>> Calling COPY_TILING_DATA_NO_CUBE()\n[TEST]  aclnnIncreFlashAttentionV5 执行后Log: (null)
[TEST]   ✅ 算子执行成功
[TEST]   等待计算完成...
[TEST]   aclrtSynchronizeStream 执行Log: (null)
[TEST]   ✅ 计算完成，流同步成功
[TEST]   开始读取计算结果...
[TEST]   ✅ 结果拷贝成功
[TEST] 
=== 计算结果分析 ===
[TEST] 输出张量形状: [1, 32, 1, 128]
[TEST] 输出张量总元素数: 4096
[TEST] 统计信息:
[TEST]   均值 (Mean): -0.004910
[TEST]   标准差 (Std): 0.011572
[TEST]   最小值 (Min): -0.048340
[TEST]   最大值 (Max): 0.037231
[TEST]   求和 (Sum): -20.109610
[TEST] 
前16个输出元素:
[TEST]   [TEST] 0.001608 [TEST] -0.004414 [TEST] -0.016266 [TEST] -0.002985 [TEST] 
[TEST]   [TEST] 0.001696 [TEST] -0.005394 [TEST] 0.001569 [TEST] -0.006023 [TEST] 
[TEST]   [TEST] -0.015625 [TEST] 0.000415 [TEST] 0.004864 [TEST] 0.022400 [TEST] 
[TEST]   [TEST] -0.010529 [TEST] -0.017654 [TEST] -0.006191 [TEST] -0.001816 [TEST] 
[TEST] 
结果合理性检查:
[TEST]   包含NaN: 否
[TEST]   包含Inf: 否
[TEST]   零值元素数: 3
[TEST]   非零元素数: 4093
[TEST]   数值范围: [-0.048340, 0.037231]
[TEST]   ✅ 结果数值正常
[TEST] === 结果分析完成 ===

[TEST] ✅ INT8 KV Mode with IVF Sparse: PASS
[TEST] 
================================================
[TEST] 
📊 测试总结: 2/2 通过 (100.0%)
[TEST] 🎉 所有测试通过!
[TEST] ✅ ACL环境清理完成
[TEST] 
🏁 测试完成: 全部通过
